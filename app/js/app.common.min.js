/********************************************
 * @auth: zhongwanshan
 * @des: 千裙百色 APP 通用脚本
 * @email: 764341548@qq.com
 ********************************************/

var App = (function (App, $) {
    
	// 与服务器端口通讯获取或传输数据
	App.getDataFromServer = function (options) {
		$.ajax({
			type: options.type || "POST",
			url: options.url,
			data: options.data,
			dataType: options.dataType || "json",
			success: function (data) {
				options.successCallBack && options.successCallBack(data);
			},
			error: function (XMLHttpRequest, textStatus, errorThrown) {
				options.failCallBack && options.failCallBack(textStatus)
			}
		});
	};
	 
	// 获取查询字符串参数
	App.getQueryParams = function () {
		// 取得查询字符串并去掉开头问号
		var qs = (
			location.search.length
				> 0
				? location.search.substring(1)
				: ''
			);
	
		// 保存数据的对像
		var args = {};
	
		// 取得每一项
		var items = qs.split('&');
		var item = null;
		var name = null;
		var value = null;
	
		// 将每一项添加到 args 对象中
		for (var i = 0, len = items.length; i < len; i++) {
			item = items[i].split('=');
			name = item[0];
			value = item[1];
			args[name] = value;
		}

		return args;
	};

	// 设置 cookie
	App.setcookie = function (name, value) {
		var Days = 30;
		var exp = new Date();
		exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
		document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString();
	};
	// 获取 cookie
	App.getcookie = function (name) {
		var arr = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));
		if (arr != null) {
			return (arr[2]);
		} else {
			return "";
		}
	};      
	
	// 删除 cookie
	App.delcookie = function (name) {
		var exp = new Date();
		exp.setTime(exp.getTime() - 1);
		var cval = this.getcookie(name);
		if (cval != null) document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
	};
		
	// 保存本地会话
	App.setSessionStorage = function (key, sessionStorageObj) {
		window.sessionStorage.setItem(key, JSON.stringify(sessionStorageObj));
	};
		
	// 返回本地会话信息
	App.getSessionStorage = function (key) {
		return JSON.parse(window.sessionStorage.getItem(key));
	};
		
	// 保存本地存储信息
	App.setLocalStorage = function (key, localStorageObj) {
		window.localStorage.setItem(key, JSON.stringify(localStorageObj));
	};
		
	// 返回本地存储信息
	App.getLocalStorage = function (key) {
		return JSON.parse(window.localStorage.getItem(key));
	};
		
	// 错误提示
	App.showErrorTip = function (errorMag) {
		alert(errorMag);
	};
		
	// 显示加载更多图标
	App.showLoadMoreIcon = function (loadMore, imgIcon) {
		
		loadMore.html(imgIcon);
		
	};
		
	// 移除加载更多图标
	App.removeLoadMoreIcon = function (loadMore, text) {
		loadMore.html(text);
	};
	
	// 显示等待图标
	App.showWaitIcon = function(wrap, waitIcon) {
		
		if (wrap.find('.waitIcon').length > 0) {
			wrap.find('.waitIcon').show();
		} else {
			wrap.append(waitIcon);
		}
		
	};
	
	// 移除等待图标
	App.removeWaitIcon = function(wrap) {
		wrap.find('.waitIcon').hide();
	}

	return App;
} (App || {}, $));